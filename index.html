<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <!-- CHART.JS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>  
    
    <!-- JQUERY -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    
    <!-- STYLES FOR CENTERING-->
    <style>
        body {
          background-color:rgb(150,150,150);
        }
        .outer-container {
        position : absolute;
        display: table;
        width: 100%;
        height: 100%;
        }
        .inner-container {
        display: table-cell;
        vertical-align: middle;
        text-align: center;
        padding-top: 60px;
        padding-bottom: 70px;
        }
        #hiddenCBQuery {
          visibility: hidden;
          width: 0;
          height: 0;
        }
      </style>

    <title>Covid Screen CB</title>	
  </head>
  <body>
    <!-- HIDDEN DIV FOR CB-DATA QUERY -->
    <div id="hiddenCBQuery"></div>
    <!-- HEADER -->
    <nav class="navbar fixed-top navbar-dark bg-dark justify-content-center" style="height: 50px;">
    <img src="https://raw.githubusercontent.com/digital-codebuz/cov-screen/main/help_grey233.svg" alt="help" style="padding-right: 10px"><a style="color:rgb(233,233,233)" href="https://www.cottbus.de/verwaltung/gb_iii/gesundheit/corona/index.html">Covid Screen Cottbus/Ch&oacute;&sacute;ebuz</a>
    </nav>
    <!-- FOOTER BUTTON FOR MODAL -->
    <nav class="navbar fixed-bottom navbar-dark bg-dark justify-content-center" style="height: 60px;"><img src="https://raw.githubusercontent.com/digital-codebuz/cov-screen/main/info.svg" alt="help">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" style="color:rgb(233,233,233); background-color:rgba(50,50,50,0); border: 0px;">
          Quelle - Hinweise - Impressum 
          </button>    
    </nav>
    <!-- MODAL -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Covid Screen Cottbus/Ch&oacute;&sacute;ebuz</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
                <h6>Quellenvermerk:</h6><br>
                <p>Stadt Cottbus/Ch&oacute;&sacute;ebuz (Gesundheitsamt)</p>
                <p>Robert Koch-Institut (RKI), dl-de/by-2-0</p><br>
                
                <h6>Datendownload:</h6><br>
                <p><a>1.)&nbsp;</a><a href="https://www.rki.de/DE/Content/InfAZ/N/Neuartiges_Coronavirus/Daten/Fallzahlen_Kum_Tab.html">Robert Koch-Institut</a></p>
                <p>2.) Download: Fallzahlen_Kum_Tab.xlsx</p>
                <p>3.) Excel: Fallzahlen_Kum_Tab BL_7-Tage-Fallzahlen</p>
                <p><a>4.)&nbsp;</a><a href="https://www.cottbus.de/verwaltung/gb_iii/gesundheit/corona/index.html">Corona-Lage auf cottbus.de</a></p><br>
                
                <h6>Hinweise:</h6><br>
                <p>Ein Plus- und/oder Minussymbol gibt die Veränderung zum Vortag an.</p>
                <p>Die Fallzahlen aus Cottbus/Ch&oacute;&sacute;ebuz werden momentan täglich vom Administrator manuell (siehe Uhrzeit weiter unten) von der Internetseite der Stadt Cottbus/Ch&oacute;&sacute;ebuz übernommen (siehe Punkt 4 bei Datendownload).</p>
                <p>Nutzer können die aktuellen Fallzahlen, die auf der Internetseite der Stadt Cottbus/Ch&oacute;&sacute;ebuz veröffentlicht werden, direkt abrufen bzw. hinzuladen.</p>
                <p>Die Balkendiagramme zeigen monatlich die Anzahl der am Stichtag (jeweils der 6.) aktuell infizierten Personen. Der Datensatz vom RKI (siehe Quellenvermerk) beginnt ab 6. Mai 2020, daher beginnt die Zeitreihe ab diesem Datum.</p><br>
                
                <h6>Impressum:</h6><br>
                <p>St. Stöhr (STVW CB/FB61)</p>
                <p>23. Dezember 2020, 22:33 Uhr</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    <!-- CENTERING CONTAINER -->
    <div class="outer-container">
    <div class="inner-container">
    <div class="container">
    <div class="row justify-content-center">
    <!-- UPDATE -->
		<div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243); border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
					        <h6 class="card-subtitle mb-2 text-muted">Update</h6>
                  <h4 class="card-title"><a>23.12.2020</a></h4>
                  <div class="card-footer" style="width: auto; height: 50px; background-color: #343a40">
                    <!--<img src="https://raw.githubusercontent.com/digital-codebuz/cov-screen/main/load.svg" id="grapCBData" alt="" style="padding-right: 10px;">-->
                    <small class="text-muted"><a id="datumUhrzeit" style="color: rgb(243,243,243);">...</a></small> <!-- Lade Zahlen von Cottbus.de / Not working CORS -->
                  </div>
                </div>
            </div>
        </div>
    <!-- INZIDENZ -->
		<div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
                    <h6 class="card-subtitle mb-2 text-muted">7-Tage-Inzidenz</h6>
                    <h4 class="card-title"><a id="countup">410</a><a style="color:rgb(25,150,0);font-size: 0.7em; padding-left: 10px;">-</a><a id="countup" style="color:rgb(25,150,0);font-size: 0.7em">26</a></h4>
                    <!-- Stand 22.12.2020 22h: 436/+47 -->
                    <!-- Stand 21.12.2020 10h: 408/+19 -->
                    <div class="card-footer" style="width: auto; background-color: #343a40; height: 50px;">
                      <small class="text-muted"><a id="siebenTageInzidenz" style="color: rgb(243,243,243);">...</a></small>
                    </div>
                </div>
            </div>
        </div>
    <!-- INFEKTIONEN -->    
		<div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
                    <h6 class="card-subtitle mb-2 text-muted">Aktuell infiziert</h6>
                    <h4 class="card-title"><a id="countup">1197</a><a style="color:rgb(250,0,0);font-size: 0.7em; padding-left: 10px;">+</a><a id="countup" style="color:rgb(250,0,0);font-size: 0.7em;">67</a></h4>
                    <!-- Stand 22.12.2020 22h: 1130/-91 -->
                    <!-- Stand 21.12.2020 10h: 1099/-122 -->
                    <div class="card-footer" style="width: auto; background-color: #343a40; height: 50px;">
                      <small class="text-muted"><a id="aktuellInfizierte" style="color: rgb(243,243,243);">...</a></small>
                    </div>
                </div>
            </div>
        </div>
    <!-- GENESENE -->    
    <div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
                    <h6 class="card-subtitle mb-2 text-muted">Genesene</h6>
                    <h4 class="card-title"><a id="countup">1017</a><!--<a style="color:rgb(25, 150, 0);font-size: 0.7em; padding-left: 10px;"></a><a id="countup" style="color:rgb(25,150,0);font-size: 0.7em;"></a>--></h4>
                    <!-- Stand 22.12.2020 22h: 1017/+166 -->
                    <!-- Stand 21.12.2020 10h: 1000/+149 -->
                    <div class="card-footer" style="width: auto; background-color: #343a40; height: 50px;">
                      <small class="text-muted"><a id="genesene" style="color: rgb(243,243,243);">...</a></small>
                    </div>
                </div>
            </div>
        </div>
    <!-- VERSTORBENE -->    
    <div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
                    <h6 class="card-subtitle mb-2 text-muted">Verstorbene</h6>
                    <h4 class="card-title"><a id="countup">70</a><!--<a style="color:rgb(250,0,0);font-size: 0.7em; padding-left: 10px;"></a><a id="countup" style="color:rgb(250,0,0);font-size: 0.7em"></a>--></h4>
                    <!-- Stand 22.12.2020 10h: 70/+5 -->
                    <!-- Stand 21.12.2020 10h: 65/0 -->
                    <div class="card-footer" style="width: auto; background-color: #343a40; height: 50px;">
                      <small class="text-muted"><a id="verstorbene" style="color: rgb(243,243,243);">...</a></small>
                    </div>
                </div>
            </div>
        </div>
    <!-- QUARANTÄNE -->
    <div class="col-auto mb-3">
            <div class="card" style="width: 18rem; background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body" style="padding-left: 0; padding-right: 0; padding-bottom: 0;">
                    <h6 class="card-subtitle mb-2 text-muted">Quarant&auml;ne</h6>
                    <h4 class="card-title"><a id="countup">2876</a><a style="color:rgb(25, 150, 0);font-size: 0.7em; padding-left: 10px;">-</a><a id="countup" style="color:rgb(25,150,0);font-size: 0.7em;">421</a></h4>
                    <!-- Stand 22.12.2020 22h: 3297/-483 -->
                    <!-- Stand 21.12.2020 10h: 3788/-2 -->
                    <div class="card-footer" style="width: auto; background-color: #343a40; height: 50px;">
                      <small class="text-muted"><a id="quarantaene" style="color: rgb(243,243,243);">...</a></small>
                    </div>
                </div>
            </div>
        </div>
    <!-- CHART 1 = INFEKTIONSVERLAUF CB-->
		<div class="col-auto mb-3">
            <div class="card" style="width: 18rem; height: 10rem;background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body">
                    <canvas id="chart1"></canvas>
                </div>
            </div>
        </div>
    <!-- CHART 2 = INFIZIERTE NACH ALTER-->
    <div class="col-auto mb-3">
            <div class="card" style="width: 18rem; height: 10rem;background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body">
                    <canvas id="chart2"></canvas>
                </div>
            </div>
        </div>
    <!-- CHART 3 = VERSTORBENE NACH ALTER -->
    <div class="col-auto mb-3">
            <div class="card" style="width: 18rem; height: 10rem;background-color: rgb(243,243,243);border: 1px solid rgb(100,100,100);">
                <div class="card-body">
                    <canvas id="chart3"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
</div>
</div>
<!-- JAVASCRIPT START -->
<script>
// CHART 1 - LINECHART INFEKTIONSVERLAUF
new Chart(document.getElementById("chart1"), {
    type: 'bar',
    data: {
      labels: ["M", "J", "J", "A", "S", "O", "N", "D"],
      datasets: [
        {
          backgroundColor: ["rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)", "rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)"],
          data: [125,18,30,36,49,185,1489,2833]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Infektionsverlauf in Brandenburg'
      }
    }
});
// CHART 2 - BARCHART INFIZIERT NACH ALTER
new Chart(document.getElementById("chart2"), {
    type: 'bar',
    data: {
      labels: ["M", "J", "J", "A", "S", "O", "N", "D"],
      datasets: [
        {
          backgroundColor: ["rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)", "rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)"],
          data: [374,135,151,299,460,925,6689,7368]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Infektionsverlauf in Dtl. Mittelwert'
      }
    }
});
// CHART 3 - BARCHART VERSTORBEN NACH ALTER
new Chart(document.getElementById("chart3"), {
    type: 'bar',
    data: {
      labels: ["M", "J", "J", "A", "S", "O", "N", "D"],
      datasets: [
        {
          backgroundColor: ["rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)", "rgb(250,0,0)", "rgb(250,0,0)","rgb(250,0,0)","rgb(250,0,0)"],
          data: [5980,2160,2422,4783,7352,14803,107030,117880]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Infektionsverlauf in Deutschland'
      }
    }
});
// UPCOUNTER
// https://jshakespeare.com/simple-count-up-number-animation-javascript-react/
// How long you want the animation to take, in ms
const animationDuration = 2000;
// Calculate how long each ‘frame’ should last if we want to update the animation 60 times per second
const frameDuration = 1000 / 60;
// Use that to calculate how many frames we need to complete the animation
const totalFrames = Math.round( animationDuration / frameDuration );
// An ease-out function that slows the count as it progresses
const easeOutQuad = t => t * ( 2 - t );

// The animation function, which takes an Element
const animateCountUp = el => {
	let frame = 0;
	const countTo = parseInt( el.innerHTML, 10 );
	// Start the animation running 60 times per second
	const counter = setInterval( () => {
		frame++;
		// Calculate our progress as a value between 0 and 1
		// Pass that value to our easing function to get our
		// progress on a curve
		const progress = easeOutQuad( frame / totalFrames );
		// Use the progress value to calculate the current count
		const currentCount = Math.round( countTo * progress );

		// If the current count has changed, update the element
		if ( parseInt( el.innerHTML, 10 ) !== currentCount ) {
			el.innerHTML = currentCount;
		}

		// If we’ve reached our last frame, stop the animation
		if ( frame === totalFrames ) {
			clearInterval( counter );
		}
	}, frameDuration );
};

// DATEN VON COTTBUS HOLEN FUNKTIONIERT NICHT, DA COTTBUS.DE VERBIETET

        // Run the animation on all elements with a class of ‘countup’
//        window.onload = function() {
//          const countupEls = document.querySelectorAll( '#countup' );
//          countupEls.forEach( animateCountUp );
//        };

//        function killAltes(){
//          document.getElementById("datumUhrzeit").innerHTML = new Date().toLocaleString();
//          document.getElementById("siebenTageInzidenz").innerHTML = "";
//          document.getElementById("aktuellInfizierte").innerHTML = "";
//          document.getElementById("genesene").innerHTML = "";
//          document.getElementById("verstorbene").innerHTML = "";
//          document.getElementById("quarantaene").innerHTML = "";
//        }

        // JQUERY GRAP CB-DATA
//        $(document).ready(function(){
          
//          $("#hiddenCBQuery").load("http://www.cottbus.de/verwaltung/gb_iii/gesundheit/corona/index.html tbody");
//          var z = $("#hiddenCBQuery");
          
//          $("#grapCBData").click(function(){
          
//            killAltes();

          //document.getElementById("datumUhrzeit").innerHTML = "";
          //document.getElementById("#siebenTageInzidenz").innerHTML = "";
          //document.getElementById("#aktuellInfizierte").innerHTML = "";
          //document.getElementById("#genesene").innerHTML = "";
          //document.getElementById("#verstorbene").innerHTML = "";
          //document.getElementById("#quarantaene").innerHTML = "";

          // Datum und Uhrzeit
          //$("#datumUhrzeit").append(z[0].children[0].children[0].children[1].children[0].innerHTML);
          //$("#dateTime").z[0].children[0].children[0].children[1].children[0].innerHTML;
          
          // 7-Tage-Inzidenz
//          $("#siebenTageInzidenz").append(z[0].children[0].children[6].children[1].innerHTML);
          //$("#inzidenz").z[0].children[0].children[6].children[1].innerHTML;
          
          // Aktuell Infizierte Personen
//          $("#aktuellInfizierte").append(z[0].children[0].children[5].children[1].innerHTML);
          //$("#infiziert").z[0].children[0].children[5].children[1].innerHTML;
          
          // Veränderung zum Vortag
          //document.getElementById("#aktuellInfizierte").innerHTML = "";
          //$("#aktuellInfizierte").append(z[0].children[0].children[2].children[1].innerHTML);
          //$("#vortag").z[0].children[0].children[2].children[1].innerHTML;
          
          // Genesene
//          $("#genesene").append(z[0].children[0].children[3].children[1].innerHTML);
          //$("#genesen").z[0].children[0].children[3].children[1].innerHTML;
          
          // Verstorbene
//          $("#verstorbene").append(z[0].children[0].children[4].children[1].innerHTML);
          //$("#verstorben").z[0].children[0].children[4].children[1].innerHTML;
          
          // Quarantäne
//          $("#quarantaene").append(z[0].children[0].children[7].children[1].innerHTML);
          //$("#quarantaene").z[0].children[0].children[7].children[1].innerHTML;

//        });
//        });
</script>
</body>
</html>